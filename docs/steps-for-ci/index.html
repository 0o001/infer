<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.54">


<title data-react-helmet="true">Recommended flow for CI | Infer</title>

<meta data-react-helmet="true" name="docsearch:version" content="0.17.0"><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Recommended flow for CI | Infer"><meta data-react-helmet="true" name="description" content="The recommended flow for CI integration is to determine the modified files, and"><meta data-react-helmet="true" property="og:description" content="The recommended flow for CI integration is to determine the modified files, and"><meta data-react-helmet="true" property="og:url" content="https://fbinfer.com/docs/steps-for-ci">

<link data-react-helmet="true" rel="shortcut icon" href="/img/favicon.png">


<link rel="stylesheet" href="/styles.20899050.css">


<link rel="preload" href="/styles.e8791e86.js" as="script">

<link rel="preload" href="/runtime~main.076e7dc7.js" as="script">

<link rel="preload" href="/main.abec7f1e.js" as="script">

<link rel="preload" href="/1.3d0db337.js" as="script">

<link rel="preload" href="/2.fb5ad4be.js" as="script">

<link rel="preload" href="/3.bfc51fa9.js" as="script">

<link rel="preload" href="/1be78505.b3cf3500.js" as="script">

<link rel="preload" href="/20ac7829.9ebbf78c.js" as="script">

<link rel="preload" href="/17896441.143f426e.js" as="script">

<link rel="preload" href="/5cc8be7b.77e25061.js" as="script">

</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=window.matchMedia("(prefers-color-scheme: dark)"),n=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==n?t(n):e.matches&&t("dark")}()</script>
<div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/logo.png" alt="Infer Logo"><strong class="navbar__title">Infer</strong></a></div><div class="navbar__items navbar__items--right"><a class="navbar__item navbar__link" href="/docs/getting-started">Docs</a><a class="navbar__item navbar__link" href="/docs/support">Support</a><a class="navbar__item navbar__link" href="/blog">Blog</a><a target="_blank" rel="noopener noreferrer" href="https://twitter.com/fbinfer" class="navbar__item navbar__link">Twitter</a><a target="_blank" rel="noopener noreferrer" href="https://www.facebook.com/inferstaticanalyzer" class="navbar__item navbar__link">Facebook</a><a target="_blank" rel="noopener noreferrer" href="https://github.com/facebook/infer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div><div class="navbar__search"><span aria-label="expand searchbar" role="button" class="search-icon" tabindex="0"></span><input type="search" id="search_input_react" placeholder="Search" aria-label="Search" class="navbar__search-input search-bar"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/"><img class="navbar__logo" src="/img/logo.png" alt="Infer Logo"><strong class="navbar__title">Infer</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" position="right" href="/docs/getting-started">Docs</a></li><li class="menu__list-item"><a class="menu__link" position="right" href="/docs/support">Support</a></li><li class="menu__list-item"><a class="menu__link" position="right" href="/blog">Blog</a></li><li class="menu__list-item"><a target="_blank" rel="noopener noreferrer" href="https://twitter.com/fbinfer" class="menu__link" position="right">Twitter</a></li><li class="menu__list-item"><a target="_blank" rel="noopener noreferrer" href="https://www.facebook.com/inferstaticanalyzer" class="menu__link" position="right">Facebook</a></li><li class="menu__list-item"><a target="_blank" rel="noopener noreferrer" href="https://github.com/facebook/infer" class="menu__link" position="right">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><div class="docSidebarContainer_1cYp"><div class="sidebar_1kLs"><div class="menu menu--responsive menu_w2sC"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Quick Start</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/getting-started">Getting started with Infer</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/hello-world">Hello, World!</a></li></ul></li><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">User Guide</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/infer-workflow">Infer workflow</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/analyzing-apps-or-projects">Analyzing apps or projects</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active" tabindex="0" href="/docs/steps-for-ci">Recommended flow for CI</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/checkers">Infer : AI</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/eradicate">Infer : Eradicate</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/linters">Infer : AL</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/racerd">Infer : RacerD</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/experimental-checkers">Infer : Experimental Checkers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/advanced-features">Advanced usage</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/adding-models">Adding models</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/docs/man-pages">Infer Manuals</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Foundations</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/about-Infer">About Infer</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/separation-logic-and-bi-abduction">Separation logic and bi-abduction</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/limitations">Limitations, etc</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Bug Types Reference</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/checkers-bug-types">Checkers bug types</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/eradicate-warnings">Eradicate warnings</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/linters-bug-types">Linters bug types</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Contribute</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/absint-framework">Building checkers with the Infer.AI framework</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/adding-checkers">Simple intraprocedural checkers</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/internal-API">Infer Internal OCaml Modules API</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Versions</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/docs/versions">Documentation Versions</a></li></ul></li></ul></div></div></div><main class="docMainContainer_FFX1"><div class="container padding-vert--lg docItemWrapper_1cc7"><div class="row"><div class="col docItemCol_2GOA"><div class="docItemContainer_2cwg"><article><div><span class="badge badge--secondary">Version: 0.17.0</span></div><header><h1 class="docTitle_1vWb">Recommended flow for CI</h1></header><div class="markdown"><p>The recommended flow for CI integration is to determine the modified files, and
run the analysis in reactive mode starting from those files. If you would like
to run more than one analyzer, it is more efficient to separate the capture
phase, so that the result can be used by all the analyzers.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="differential-workflow"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#differential-workflow" title="Direct link to heading">#</a>Differential Workflow</h3><p>Here&#x27;s how to run infer on two versions of a project and compare the results in
general.</p><p>Assume the project uses git, <code>feature</code> is the feature branch (the code change
you want to analyze), <code>master</code> is the master branch, and <code>make</code> builds the
project.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># go to feature branch if not there already</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">git</span><span class="token plain"> checkout feature</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># get list of changed files</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">git</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">diff</span><span class="token plain"> --name-only origin/feature</span><span class="token punctuation" style="color:rgb(199, 146, 234)">..</span><span class="token plain">origin/master </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> index.txt</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">## first run: feature branch</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># run infer on the feature branch</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">infer capture -- </span><span class="token function" style="color:rgb(130, 170, 255)">make</span><span class="token plain"> -j </span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token plain">  </span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># assuming a machine with 4 cores</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">infer analyze --changed-files-index index.txt</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># store the infer report</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">cp</span><span class="token plain"> infer-out/report.json report-feature.json</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic">## second run: master branch</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token function" style="color:rgb(130, 170, 255)">git</span><span class="token plain"> checkout master</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># run capture in reactive mode so that previously-captured source files are kept if they are up-to-date</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">infer capture --reactive -- </span><span class="token function" style="color:rgb(130, 170, 255)">make</span><span class="token plain"> -j </span><span class="token number" style="color:rgb(247, 140, 108)">4</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">infer analyze --reactive --changed-files-index index.txt</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain"></span><span class="token comment" style="color:rgb(105, 112, 152);font-style:italic"># compare reports</span><span class="token plain"></span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">infer reportdiff --report-current report-feature.json --report-previous infer-out/report.json</span></div></div></div></div></div><p>At the end of this process, &quot;infer-out/differential/&quot; contains three files,
which follow the same format as normal infer JSON reports:</p><ul><li>introduced.json contains the issues found in the feature branch but not in
master;</li><li>fixed.json contains the issues found in master but not in the feature branch;</li><li>preexisting.json contains the issues found in both branches.</li></ul><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="example-android-gradle"></a><a aria-hidden="true" tabindex="-1" class="hash-link" href="#example-android-gradle" title="Direct link to heading">#</a>Example: Android Gradle</h3><p>The following CI script runs the <code>infer</code> and <code>eradicate</code> analyzers. Assume again
that <code>feature</code> is the feature branch, and <code>master</code> is the master branch.</p><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-bash codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token function" style="color:rgb(130, 170, 255)">git</span><span class="token plain"> </span><span class="token function" style="color:rgb(130, 170, 255)">diff</span><span class="token plain"> --name-only origin/feature</span><span class="token punctuation" style="color:rgb(199, 146, 234)">..</span><span class="token plain">origin/master </span><span class="token operator" style="color:rgb(137, 221, 255)">&gt;</span><span class="token plain"> index.txt</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">infer capture -- ./gradlew --offline assembleDebug</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">infer analyze --fail-on-issue --eradicate --changed-files-index ./index.txt</span></div></div></div></div></div><p>Notice that</p><ul><li>We use git to find the changed files <code>git diff --name-only</code></li><li>We run capture only once, and the output is kept for the subsequent analyses</li><li>We run the eradicate analysis alongside the default analyses: <code>--eradicate</code></li><li>We analyze only the changed files <code>--changed-files-index ./index.txt</code></li></ul></div></article><div class="margin-vert--lg"><nav class="pagination-nav"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/analyzing-apps-or-projects"><div class="pagination-nav__link--sublabel">Previous</div><div class="pagination-nav__link--label">« Analyzing apps or projects</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/checkers"><div class="pagination-nav__link--sublabel">Next</div><div class="pagination-nav__link--label">Infer : AI »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"><ul class="contents contents__left-border"><li><a href="#differential-workflow" class="contents__link">Differential Workflow</a></li><li><a href="#example-android-gradle" class="contents__link">Example: Android Gradle</a></li></ul></div></div></div></div></main></div></div><footer class="footer"><div class="container"><div class="row footer__links"><div class="col footer__col"><h4 class="footer__title">Docs</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/getting-started">Quick Start</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/infer-workflow">User Guide</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/about-Infer">Foundations</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/checkers-bug-types">Bug Types Reference</a></li><li class="footer__item"><a class="footer__link-item" href="/docs/absint-framework">Contribute</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Community</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/docs/support">Support</a></li></ul></div><div class="col footer__col"><h4 class="footer__title">Social</h4><ul class="footer__items"><li class="footer__item"><a class="footer__link-item" href="/blog">Blog</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://github.com/facebook/infer">GitHub</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://twitter.com/fbinfer">Twitter</a></li><li class="footer__item"><a class="footer__link-item" target="_blank" rel="noopener noreferrer" href="https://www.facebook.com/inferstaticanalyzer">Facebook</a></li></ul></div></div><div class="text--center"><div>Copyright © 2020 Facebook, Inc. Built with Docusaurus.</div></div></div></footer>
</div>

<script src="/styles.e8791e86.js"></script>

<script src="/runtime~main.076e7dc7.js"></script>

<script src="/main.abec7f1e.js"></script>

<script src="/1.3d0db337.js"></script>

<script src="/2.fb5ad4be.js"></script>

<script src="/3.bfc51fa9.js"></script>

<script src="/1be78505.b3cf3500.js"></script>

<script src="/20ac7829.9ebbf78c.js"></script>

<script src="/17896441.143f426e.js"></script>

<script src="/5cc8be7b.77e25061.js"></script>


</body>
</html>