(window.webpackJsonp=window.webpackJsonp||[]).push([[69],{206:function(e,t,n){"use strict";n.r(t),n.d(t,"frontMatter",(function(){return o})),n.d(t,"metadata",(function(){return l})),n.d(t,"rightToc",(function(){return c})),n.d(t,"default",(function(){return b}));var a=n(1),i=n(9),r=(n(0),n(232)),o={title:"List of all issue types"},l={id:"all-issue-types",title:"List of all issue types",description:"Here is an overview of the issue types currently reported by Infer. Currently outdated and being worked on!",source:"@site/docs/all-issue-types.md",permalink:"/docs/next/all-issue-types",version:"next",sidebar:"docs",previous:{title:"Infer Manuals",permalink:"/docs/next/man-pages"},next:{title:"Annotation Reachability",permalink:"/docs/next/checker-annotation-reachability"}},c=[{value:"ASSIGN_POINTER_WARNING",id:"assign_pointer_warning",children:[]},{value:"BAD_POINTER_COMPARISON",id:"bad_pointer_comparison",children:[]},{value:"CAPTURED_STRONG_SELF",id:"captured_strong_self",children:[]},{value:"CHECKERS_FRAGMENT_RETAINS_VIEW",id:"checkers_fragment_retains_view",children:[]},{value:"CHECKERS_IMMUTABLE_CAST",id:"checkers_immutable_cast",children:[]},{value:"COMPONENT_FACTORY_FUNCTION",id:"component_factory_function",children:[]},{value:"COMPONENT_INITIALIZER_WITH_SIDE_EFFECTS",id:"component_initializer_with_side_effects",children:[]},{value:"COMPONENT_WITH_MULTIPLE_FACTORY_METHODS",id:"component_with_multiple_factory_methods",children:[]},{value:"COMPONENT_WITH_UNCONVENTIONAL_SUPERCLASS",id:"component_with_unconventional_superclass",children:[]},{value:"CXX_REFERENCE_CAPTURED_IN_OBJC_BLOCK",id:"cxx_reference_captured_in_objc_block",children:[]},{value:"DEADLOCK",id:"deadlock",children:[]},{value:"DEAD_STORE",id:"dead_store",children:[]},{value:"DIRECT_ATOMIC_PROPERTY_ACCESS",id:"direct_atomic_property_access",children:[]},{value:"DISCOURAGED_WEAK_PROPERTY_CUSTOM_SETTER",id:"discouraged_weak_property_custom_setter",children:[]},{value:"EMPTY_VECTOR_ACCESS",id:"empty_vector_access",children:[]},{value:"ERADICATE_CONDITION_REDUNDANT",id:"eradicate_condition_redundant",children:[]},{value:"ERADICATE_FIELD_NOT_INITIALIZED",id:"eradicate_field_not_initialized",children:[]},{value:"ERADICATE_FIELD_NOT_NULLABLE",id:"eradicate_field_not_nullable",children:[]},{value:"ERADICATE_INCONSISTENT_SUBCLASS_PARAMETER_ANNOTATION",id:"eradicate_inconsistent_subclass_parameter_annotation",children:[]},{value:"ERADICATE_INCONSISTENT_SUBCLASS_RETURN_ANNOTATION",id:"eradicate_inconsistent_subclass_return_annotation",children:[]},{value:"ERADICATE_PARAMETER_NOT_NULLABLE",id:"eradicate_parameter_not_nullable",children:[]},{value:"ERADICATE_RETURN_NOT_NULLABLE",id:"eradicate_return_not_nullable",children:[]},{value:"ERADICATE_RETURN_OVER_ANNOTATED",id:"eradicate_return_over_annotated",children:[]},{value:"GLOBAL_VARIABLE_INITIALIZED_WITH_FUNCTION_OR_METHOD_CALL",id:"global_variable_initialized_with_function_or_method_call",children:[]},{value:"INTERFACE_NOT_THREAD_SAFE",id:"interface_not_thread_safe",children:[]},{value:"IVAR_NOT_NULL_CHECKED",id:"ivar_not_null_checked",children:[]},{value:"LOCK_CONSISTENCY_VIOLATION",id:"lock_consistency_violation",children:[{value:"Fixing Lock Consistency Violation reports",id:"fixing-lock-consistency-violation-reports",children:[]}]},{value:"MEMORY_LEAK",id:"memory_leak",children:[{value:"Memory leak in C",id:"memory-leak-in-c",children:[]},{value:"Memory leak in Objective-C",id:"memory-leak-in-objective-c",children:[]}]},{value:"MIXED_SELF_WEAKSELF",id:"mixed_self_weakself",children:[]},{value:"MULTIPLE_WEAKSELF",id:"multiple_weakself",children:[]},{value:"MUTABLE_LOCAL_VARIABLE_IN_COMPONENT_FILE",id:"mutable_local_variable_in_component_file",children:[]},{value:"NULL_DEREFERENCE",id:"null_dereference",children:[{value:"Null dereference in C",id:"null-dereference-in-c",children:[]},{value:"Null dereference in Objective-C",id:"null-dereference-in-objective-c",children:[]},{value:"Null dereference in Java",id:"null-dereference-in-java",children:[]}]},{value:"PARAMETER_NOT_NULL_CHECKED",id:"parameter_not_null_checked",children:[]},{value:"POINTER_TO_CONST_OBJC_CLASS",id:"pointer_to_const_objc_class",children:[]},{value:"PREMATURE_NIL_TERMINATION_ARGUMENT",id:"premature_nil_termination_argument",children:[]},{value:"REGISTERED_OBSERVER_BEING_DEALLOCATED",id:"registered_observer_being_deallocated",children:[]},{value:"RESOURCE_LEAK",id:"resource_leak",children:[{value:"Resource leak in C",id:"resource-leak-in-c",children:[]},{value:"Resource leak in Java",id:"resource-leak-in-java",children:[]},{value:"Basics and Standard Idiom",id:"basics-and-standard-idiom",children:[]},{value:"Nested_Allocations",id:"nested_allocations",children:[]},{value:"Allocation of JSonParser and Cursor resources",id:"allocation-of-jsonparser-and-cursor-resources",children:[]},{value:"Escaping resources and exceptions",id:"escaping-resources-and-exceptions",children:[]},{value:"Java 7&#39;s try-with-resources",id:"java-7s-try-with-resources",children:[]}]},{value:"RETAIN_CYCLE",id:"retain_cycle",children:[]},{value:"STARVATION",id:"starvation",children:[]},{value:"STATIC_INITIALIZATION_ORDER_FIASCO",id:"static_initialization_order_fiasco",children:[]},{value:"STRICT_MODE_VIOLATION",id:"strict_mode_violation",children:[]},{value:"STRONG_DELEGATE_WARNING",id:"strong_delegate_warning",children:[]},{value:"STRONG_SELF_NOT_CHECKED",id:"strong_self_not_checked",children:[]},{value:"THREAD_SAFETY_VIOLATION",id:"thread_safety_violation",children:[{value:"Thread-safety: What is a data race",id:"thread-safety-what-is-a-data-race",children:[]},{value:"Thread-safety: Potential fixes",id:"thread-safety-potential-fixes",children:[]},{value:"Thread-safety: Conditions checked before reporting",id:"thread-safety-conditions-checked-before-reporting",children:[]},{value:"Thread-safety: Thread annotations recognized by RacerD",id:"thread-safety-thread-annotations-recognized-by-racerd",children:[]},{value:"Thread-safety: Other annotations and what they do",id:"thread-safety-other-annotations-and-what-they-do",children:[]}]},{value:"UNAVAILABLE_API_IN_SUPPORTED_IOS_SDK",id:"unavailable_api_in_supported_ios_sdk",children:[]},{value:"WEAK_SELF_IN_NO_ESCAPE_BLOCK",id:"weak_self_in_no_escape_block",children:[]}],s={rightToc:c};function b(e){var t=e.components,n=Object(i.a)(e,["components"]);return Object(r.b)("wrapper",Object(a.a)({},s,n,{components:t,mdxType:"MDXLayout"}),Object(r.b)("p",null,"Here is an overview of the issue types currently reported by Infer. Currently outdated and being worked on!"),Object(r.b)("h2",{id:"assign_pointer_warning"},"ASSIGN_POINTER_WARNING"),Object(r.b)("p",null,'Reported as "Assign Pointer Warning" by ',Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/next/checker-linters"}),"linters"),"."),Object(r.b)("p",null,"This check fires when a pointer to an Obj-C object is tagged with an ",Object(r.b)("inlineCode",{parentName:"p"},"assign"),"\nproperty (similar to the ",Object(r.b)("inlineCode",{parentName:"p"},"-Warc-unsafe-retained-assign")," compiler flag). Not\nholding a strong reference to the object makes it easy to accidentally create\nand use a dangling pointer."),Object(r.b)("h2",{id:"bad_pointer_comparison"},"BAD_POINTER_COMPARISON"),Object(r.b)("p",null,'Reported as "Bad Pointer Comparison" by ',Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/next/checker-linters"}),"linters"),"."),Object(r.b)("p",null,"Infer reports these warnings in Objective-C when a boxed primitive type such as\n",Object(r.b)("inlineCode",{parentName:"p"},"NSNumber *")," is coerced to a boolean in a comparison. For example, consider the\ncode"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-objectivec"}),"void foo(NSNumber * n) {\n  if (n) ...\n")),Object(r.b)("p",null,"The branch in the above code will be taken when the pointer ",Object(r.b)("inlineCode",{parentName:"p"},"n")," is non-",Object(r.b)("inlineCode",{parentName:"p"},"nil"),",\nbut the programmer might have actually wanted the branch to be taken when the\ninteger pointed to by ",Object(r.b)("inlineCode",{parentName:"p"},"n")," is nonzero (e.g., she may have meant to call an\naccessor like ",Object(r.b)("inlineCode",{parentName:"p"},"[n intValue]")," instead). Infer will ask the programmer explicitly\ncompare ",Object(r.b)("inlineCode",{parentName:"p"},"n")," to ",Object(r.b)("inlineCode",{parentName:"p"},"nil")," or call an accessor to clarify her intention."),Object(r.b)("h2",{id:"captured_strong_self"},"CAPTURED_STRONG_SELF"),Object(r.b)("p",null,'Reported as "Captured strongSelf" by ',Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/next/checker-self-in-block"}),"self-in-block"),"."),Object(r.b)("p",null,"This will happen in one of two cases generally:"),Object(r.b)("ol",null,Object(r.b)("li",{parentName:"ol"},"One uses ",Object(r.b)("inlineCode",{parentName:"li"},"weakSelf")," but forgot to declare it weak first."),Object(r.b)("li",{parentName:"ol"},"One is using ",Object(r.b)("inlineCode",{parentName:"li"},"strongSelf"),", declared in a block, in another (inside) block.\nThis changes the delicate balance of the ",Object(r.b)("inlineCode",{parentName:"li"},"weakSelf"),"/",Object(r.b)("inlineCode",{parentName:"li"},"strongSelf")," use in the\nfirst block. The retain cycle is avoided there because ",Object(r.b)("inlineCode",{parentName:"li"},"strongSelf")," is a\nlocal variable to the block. If ",Object(r.b)("inlineCode",{parentName:"li"},"strongSelf")," is used in the inside block,\nthen it's not a local variable anymore, but a captured variable.")),Object(r.b)("h2",{id:"checkers_fragment_retains_view"},"CHECKERS_FRAGMENT_RETAINS_VIEW"),Object(r.b)("p",null,'Reported as "Fragment Retains View" by ',Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/next/checker-fragment-retains-view"}),"fragment-retains-view"),"."),Object(r.b)("p",null,"This error type is Android-specific. It fires when a ",Object(r.b)("inlineCode",{parentName:"p"},"Fragment")," type fails to\nnullify one or more of its declared ",Object(r.b)("inlineCode",{parentName:"p"},"View")," fields in ",Object(r.b)("inlineCode",{parentName:"p"},"onDestroyView"),". In\nperformance-sensitive applications, a ",Object(r.b)("inlineCode",{parentName:"p"},"Fragment")," should initialize all ",Object(r.b)("inlineCode",{parentName:"p"},"View"),"'s\nin ",Object(r.b)("inlineCode",{parentName:"p"},"onCreateView")," and nullify them in ",Object(r.b)("inlineCode",{parentName:"p"},"onDestroyView"),". If a ",Object(r.b)("inlineCode",{parentName:"p"},"Fragment")," is placed\non the back stack and fails to nullify a ",Object(r.b)("inlineCode",{parentName:"p"},"View")," in ",Object(r.b)("inlineCode",{parentName:"p"},"onDestroyView"),", it will\nretain a useless reference to that ",Object(r.b)("inlineCode",{parentName:"p"},"View")," that will not be cleaned up until the\n",Object(r.b)("inlineCode",{parentName:"p"},"Fragment")," is resumed or destroyed."),Object(r.b)("p",null,"Action: Nullify the ",Object(r.b)("inlineCode",{parentName:"p"},"View")," in question in ",Object(r.b)("inlineCode",{parentName:"p"},"onDestroyView"),"."),Object(r.b)("h2",{id:"checkers_immutable_cast"},"CHECKERS_IMMUTABLE_CAST"),Object(r.b)("p",null,'Reported as "Checkers Immutable Cast" by ',Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/next/checker-immutable-cast"}),"immutable-cast"),"."),Object(r.b)("p",null,"This error type is reported in Java. It fires when an immutable collection is\nreturned from a method whose type is mutable."),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),"  public List<String> getSomeList() {\n    ImmutableList<String> l = foo(...);\n    return l;\n  }\n")),Object(r.b)("p",null,"This can lead to a runtime error if users of ",Object(r.b)("inlineCode",{parentName:"p"},"getSomeList")," try to modify the\nlist e.g. by adding elements."),Object(r.b)("p",null,"Action: you can change the return type to be immutable, or make a copy of the\ncollection so that it can be modified."),Object(r.b)("h2",{id:"component_factory_function"},"COMPONENT_FACTORY_FUNCTION"),Object(r.b)("p",null,'Reported as "Component Factory Function" by ',Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/next/checker-linters"}),"linters"),"."),Object(r.b)("h2",{id:"component_initializer_with_side_effects"},"COMPONENT_INITIALIZER_WITH_SIDE_EFFECTS"),Object(r.b)("p",null,'Reported as "Component Initializer With Side Effects" by ',Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/next/checker-linters"}),"linters"),"."),Object(r.b)("h2",{id:"component_with_multiple_factory_methods"},"COMPONENT_WITH_MULTIPLE_FACTORY_METHODS"),Object(r.b)("p",null,'Reported as "Component With Multiple Factory Methods" by ',Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/next/checker-linters"}),"linters"),"."),Object(r.b)("h2",{id:"component_with_unconventional_superclass"},"COMPONENT_WITH_UNCONVENTIONAL_SUPERCLASS"),Object(r.b)("p",null,'Reported as "Component With Unconventional Superclass" by ',Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/next/checker-linters"}),"linters"),"."),Object(r.b)("p",null,Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"http://componentkit.org/docs/never-subclass-components"}),"Doc in ComponentKit page")),Object(r.b)("h2",{id:"cxx_reference_captured_in_objc_block"},"CXX_REFERENCE_CAPTURED_IN_OBJC_BLOCK"),Object(r.b)("p",null,'Reported as "Cxx Reference Captured In Objc Block" by ',Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/next/checker-linters"}),"linters"),"."),Object(r.b)("p",null,"With this check, Infer detects C++ references captured in a block. Doing this is\nalmost always wrong. The reason is that C++ references are not managed pointers\n(like ARC pointers) and so the referent is likely to be gone by the time the\nblock gets executed. One solution is to do a local copy of the reference and\npass that to the block. Example:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-c"}),"(int &) v;\n...\nconst int copied_v = v;\n^{\n// use copied_v not v\n};\n")),Object(r.b)("h2",{id:"deadlock"},"DEADLOCK"),Object(r.b)("p",null,'Reported as "Deadlock" by ',Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/next/checker-starvation"}),"starvation"),"."),Object(r.b)("p",null,"This error is currently reported in Java. A deadlock occurs when two distinct\nthreads try to acquire two locks in reverse orders. The following code\nillustrates a textbook example. Of course, in real deadlocks, the lock\nacquisitions may be separated by deeply nested call chains."),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),"  public void lockAThenB() {\n    synchronized(lockA) {\n      synchronized(lockB) {\n       // do something with both resources\n      }\n    }\n  }\n\n  public void lockBThenA() {\n    synchronized(lockB) {\n      synchronized(lockA) {\n       // do something with both resources\n      }\n    }\n  }\n")),Object(r.b)("p",null,"The standard solution to a deadlock is to fix an order of lock acquisition and\nadhere to that order in all cases. Another solution may be to shrink the\ncritical sections (i.e., the code executing under lock) to the minimum required."),Object(r.b)("p",null,"Old-style containers such as ",Object(r.b)("inlineCode",{parentName:"p"},"Vector")," are synchronized on the object monitor,\nwhich means that deadlocks can occur even without explicit synchronisation on\nboth threads. For instance:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),"  public void lockAThenAddToVector() {\n    synchronized(lockA) {\n      vector.add(object);\n    }\n  }\n\n  public void lockVectorThenA() {\n    synchronized(vector) {\n      synchronized(lockA) {\n       // do something with both resources\n      }\n    }\n  }\n")),Object(r.b)("p",null,"Infer has support for detecting these deadlocks too."),Object(r.b)("p",null,"To suppress reports of deadlocks in a method ",Object(r.b)("inlineCode",{parentName:"p"},"m()")," use the\n",Object(r.b)("inlineCode",{parentName:"p"},'@SuppressLint("DEADLOCK")')," annotation, as follows:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),'  import android.annotation.SuppressLint;\n\n  @SuppressLint("DEADLOCK")\n  public void m() {\n  ...\n  }\n')),Object(r.b)("h2",{id:"dead_store"},"DEAD_STORE"),Object(r.b)("p",null,'Reported as "Dead Store" by ',Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/next/checker-liveness"}),"liveness"),"."),Object(r.b)("p",null,"This error is reported in C++. It fires when the value assigned to a variables\nis never used (e.g., ",Object(r.b)("inlineCode",{parentName:"p"},"int i = 1; i = 2; return i;"),")."),Object(r.b)("h2",{id:"direct_atomic_property_access"},"DIRECT_ATOMIC_PROPERTY_ACCESS"),Object(r.b)("p",null,'Reported as "Direct Atomic Property Access" by ',Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/next/checker-linters"}),"linters"),"."),Object(r.b)("p",null,"This check warns you when you are accessing an atomic property directly with an\nivar. This makes the atomic property not atomic anymore. So potentially you may\nget a race condition."),Object(r.b)("p",null,"To fix the problem you need to access properties with their getter or setter."),Object(r.b)("h2",{id:"discouraged_weak_property_custom_setter"},"DISCOURAGED_WEAK_PROPERTY_CUSTOM_SETTER"),Object(r.b)("p",null,'Reported as "Discouraged Weak Property Custom Setter" by ',Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/next/checker-linters"}),"linters"),"."),Object(r.b)("p",null,"This check warns you when you have a custom setter for a weak property. When\ncompiled with Automatic Reference Counting (ARC, ",Object(r.b)("inlineCode",{parentName:"p"},"-fobj-arc"),") ARC may set the\nproperty to ",Object(r.b)("inlineCode",{parentName:"p"},"nil")," without invoking the setter, for example:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-objectivec"}),'#import <Foundation/Foundation.h>\n\n@interface Employee : NSObject {\n  NSString* _name;\n  __weak Employee* _manager;\n}\n-(id)initWithName:(NSString*)name;\n@property(atomic, weak) Employee* manager;\n-(void)report;\n@end\n\n@implementation Employee\n\n-(id)initWithName:(NSString*)name {\n  _name = name;\n  return self;\n}\n\n-(NSString*)description {\n  return _name;\n}\n\n-(void)report {\n  NSLog(@"I work for %@", _manager);\n}\n\n-(Employee*)manager {\n  return _manager;\n}\n\n// DON\'T do this; ARC will not call this when setting _manager to nil.\n-(void)setManager:(Employee*)newManager {\n  NSLog(@"Meet the new boss...");\n  _manager = newManager;\n}\n\n@end\n\nint main(int argc, char *argv[])\n{\n  Employee* bob = [[Employee alloc] initWithName:@"Bob"];\n  Employee* sue = [[Employee alloc] initWithName:@"Sue"];\n  bob.manager = sue;\n  [bob report];\n  sue = nil;\n  [bob report];\n  return 0;\n}\n')),Object(r.b)("p",null,"This prints:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{}),"Meet the new boss...\nI work for Sue\nI work for (null)\n")),Object(r.b)("p",null,"Note that the custom setter was only invoked once."),Object(r.b)("h2",{id:"empty_vector_access"},"EMPTY_VECTOR_ACCESS"),Object(r.b)("p",null,'Reported as "Empty Vector Access" by ',Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/next/checker-biabduction"}),"biabduction"),"."),Object(r.b)("p",null,"This error type is reported only in C++, in versions >= C++11."),Object(r.b)("p",null,"The code is trying to access an element of a vector that Infer believes to be\nempty. Such an access will cause undefined behavior at runtime."),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-c++"}),"#include <vector>\nint foo(){\n  const std::vector<int> vec;\n  return vec[0]; // Empty vector access reported here\n}\n")),Object(r.b)("h2",{id:"eradicate_condition_redundant"},"ERADICATE_CONDITION_REDUNDANT"),Object(r.b)("p",null,'Reported as "Condition Redundant" by ',Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/next/checker-eradicate"}),"eradicate"),"."),Object(r.b)("p",null,"This report is inactive by default. Condition (x != null) or (x == null) when x\ncannot be null: the first condition is always true and the second is always\nfalse"),Object(r.b)("p",null,"Example:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),'class C {\n  void m() {\n    String s = new String("abc");\n    if (s != null) {\n      int n = s.length();\n    }\n  }\n}\n')),Object(r.b)("p",null,"Action: Make sure that the annotations are correct, as the condition is\nconsidered redundant based on the existing annotations. In particular, check the\nannotation of any input parameters and fields of the current method, as well as\nthe annotations of any method called directly by the current method, if\nrelevant. If the annotations are correct, you can remove the redundant case."),Object(r.b)("h2",{id:"eradicate_field_not_initialized"},"ERADICATE_FIELD_NOT_INITIALIZED"),Object(r.b)("p",null,'Reported as "Field Not Initialized" by ',Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/next/checker-eradicate"}),"eradicate"),"."),Object(r.b)("p",null,"The constructor does not initialize a field f which is not annotated with\n@Nullable"),Object(r.b)("p",null,"Example:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),"class C {\n  String f;\n\n  C () { // field f not initialized and not annotated @Nullable\n  }\n}\n")),Object(r.b)("p",null,"Action: The preferred action is to initialize the field with a value that is not\nnull. If, by design, null is a valid value for the field, then it should be\nannotated with @Nullable."),Object(r.b)("h2",{id:"eradicate_field_not_nullable"},"ERADICATE_FIELD_NOT_NULLABLE"),Object(r.b)("p",null,'Reported as "Field Not Nullable" by ',Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/next/checker-eradicate"}),"eradicate"),"."),Object(r.b)("p",null,"An assignment x.f = v where v could be null and field f is not annotated with\n@Nullable."),Object(r.b)("p",null,"Example:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),"class C {\n  String f;\n\n  void foo(@Nullable String s) {\n    f = s;\n  }\n}\n")),Object(r.b)("p",null,"Action: The preferred action is to ensure that a null value is never stored in\nthe field, by changing the code or changing annotations. If this cannot be done,\nadd a @Nullable annotation to the field. This annotation might trigger more\nwarnings in other code that uses the field, as that code must now deal with null\nvalues."),Object(r.b)("h2",{id:"eradicate_inconsistent_subclass_parameter_annotation"},"ERADICATE_INCONSISTENT_SUBCLASS_PARAMETER_ANNOTATION"),Object(r.b)("p",null,'Reported as "Inconsistent Subclass Parameter Annotation" by ',Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/next/checker-eradicate"}),"eradicate"),"."),Object(r.b)("p",null,"A parameter of the overridden method is missing a @Nullable annotation present in the superclass."),Object(r.b)("p",null,"Action: choose a consistent annotation based on the desired invariant."),Object(r.b)("p",null,"Example:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),"class A {\n\n  int len(@Nullable String s) {\n    if (s != null) {\n      return s.length();\n    } else {\n      return 0;\n    }\n  }\n}\n\nclass B extends A {\n\n  int len(String s) {  // @Nullable missing.\n    return s.length();\n  }\n}\n")),Object(r.b)("p",null,"A consistent use of @Nullable on parameters across subtyping should prevent runtime issue like in:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),"public class Main {\n\n  String s;\n\n  int foo() {\n    A a = new B();\n    return a.len(s);\n  }\n}\n")),Object(r.b)("h2",{id:"eradicate_inconsistent_subclass_return_annotation"},"ERADICATE_INCONSISTENT_SUBCLASS_RETURN_ANNOTATION"),Object(r.b)("p",null,'Reported as "Inconsistent Subclass Return Annotation" by ',Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/next/checker-eradicate"}),"eradicate"),"."),Object(r.b)("p",null,"The return type of the overridden method is annotated @Nullable, but the\ncorresponding method in the superclass is not."),Object(r.b)("p",null,"Action: choose a consistent annotation based on the desired invariant."),Object(r.b)("p",null,"Example:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),'class A {\n  String create() {\n    return new String("abc");\n  }\n}\n\nclass B extends A {\n  @Nullable String create() {  // Inconsistent @Nullable annotation.\n      return null;\n  }\n}\n')),Object(r.b)("p",null,"A consistent use of ",Object(r.b)("inlineCode",{parentName:"p"},"@Nullable")," on the return type across subtyping should prevent\nruntime issue like in:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),"class Main {\n\n  int foo(A a) {\n     String s = a.create();\n     return s.length();\n  }\n\n  void main(String[] args) {\n     A a = new B();\n     foo(a);\n  }\n\n}\n")),Object(r.b)("h2",{id:"eradicate_parameter_not_nullable"},"ERADICATE_PARAMETER_NOT_NULLABLE"),Object(r.b)("p",null,'Reported as "Parameter Not Nullable" by ',Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/next/checker-eradicate"}),"eradicate"),"."),Object(r.b)("p",null,"Method call x.m(..., v, ...) where v can be null and the corresponding parameter\nin method m is not annotated with @Nullable"),Object(r.b)("p",null,"Example:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),"class C {\n  void m(C x) {\n    String s = x.toString()\n  }\n\n  void test(@Nullable C x) {\n    m(x);\n  }\n}\n")),Object(r.b)("p",null,"Action: The preferred action is to ensure that a null value is never passed to\nthe method, by changing the code or changing annotations. If this cannot be\ndone, add a @Nullable annotation to the relevant parameter in the method\ndeclaration. This annotation might trigger more warnings in the implementation\nof method m, as that code must now deal with null values."),Object(r.b)("h2",{id:"eradicate_return_not_nullable"},"ERADICATE_RETURN_NOT_NULLABLE"),Object(r.b)("p",null,'Reported as "Return Not Nullable" by ',Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/next/checker-eradicate"}),"eradicate"),"."),Object(r.b)("p",null,"Method m can return null, but the method's return type is not annotated with\n@Nullable"),Object(r.b)("p",null,"Example:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),"class C {\n  String m() {\n    return null;\n  }\n}\n")),Object(r.b)("p",null,"Action: The preferred action is to ensure that a null value is never returned by\nthe method, by changing the code or changing annotations. If this cannot be\ndone, add a @Nullable annotation to the the method declaration. This annotation\nmight trigger more warnings in the callers of method m, as the callers must now\ndeal with null values."),Object(r.b)("h2",{id:"eradicate_return_over_annotated"},"ERADICATE_RETURN_OVER_ANNOTATED"),Object(r.b)("p",null,'Reported as "Return Over Annotated" by ',Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/next/checker-eradicate"}),"eradicate"),"."),Object(r.b)("p",null,"This report is inactive by default. Method m is annotated with @Nullable but the\nmethod cannot return null"),Object(r.b)("p",null,"Example:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),'class C {\n  @Nullable String m() {\n    String s = new String("abc");\n    return s;\n  }\n}\n')),Object(r.b)("p",null,"Action: Make sure that the annotations are correct, as the return annotation is\nconsidered redundant based on the existing annotations. In particular, check the\nannotation of any input parameters and fields of the current method, as well as\nthe annotations of any method called directly by the current method, if\nrelevant. If the annotations are correct, you can remove the @Nullable\nannotation."),Object(r.b)("h2",{id:"global_variable_initialized_with_function_or_method_call"},"GLOBAL_VARIABLE_INITIALIZED_WITH_FUNCTION_OR_METHOD_CALL"),Object(r.b)("p",null,'Reported as "Global Variable Initialized With Function Or Method Call" by ',Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/next/checker-linters"}),"linters"),"."),Object(r.b)("p",null,"This checker warns you when the initialization of global variable contain a\nmethod or function call. The warning wants to make you aware that some functions\nare expensive. As the global variables are initialized before main() is called,\nthese initializations can slow down the start-up time of an app."),Object(r.b)("h2",{id:"interface_not_thread_safe"},"INTERFACE_NOT_THREAD_SAFE"),Object(r.b)("p",null,'Reported as "Interface Not Thread Safe" by ',Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/next/checker-racerd"}),"racerd"),"."),Object(r.b)("p",null,"This error indicates that you have invoked an interface method not annotated\nwith ",Object(r.b)("inlineCode",{parentName:"p"},"@ThreadSafe")," from a thread-safe context (e.g., code that uses locks or is\nmarked ",Object(r.b)("inlineCode",{parentName:"p"},"@ThreadSafe"),"). The fix is to add the ",Object(r.b)("inlineCode",{parentName:"p"},"@ThreadSafe")," annotation to the\ninterface or to the interface method. For background on why these annotations\nare needed, see the detailed explanation\n",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"racerd#interface-not-thread-safe"}),"here"),"."),Object(r.b)("h2",{id:"ivar_not_null_checked"},"IVAR_NOT_NULL_CHECKED"),Object(r.b)("p",null,'Reported as "Ivar Not Null Checked" by ',Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/next/checker-biabduction"}),"biabduction"),"."),Object(r.b)("p",null,"This error type is only reported in Objective-C. This is similar to Null\ndereference, but Infer hasn't found a whole trace where the error can happen,\nbut only found that a null dereference can happen if an instance variable of a\nparameter is ",Object(r.b)("inlineCode",{parentName:"p"},"nil"),". For example:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-objectivec"}),"  -(int) foo {\n      B b* = [self->_a foo]; // sending a message with receiver nil returns nil\n      return b->x; // dereferencing b, potential NPE if you pass nil as the argument a.\n  }\n")),Object(r.b)("p",null,"Possible solutions are adding a check for ",Object(r.b)("inlineCode",{parentName:"p"},"nil"),", or making sure that the method\nis not called with ",Object(r.b)("inlineCode",{parentName:"p"},"nil"),"."),Object(r.b)("h2",{id:"lock_consistency_violation"},"LOCK_CONSISTENCY_VIOLATION"),Object(r.b)("p",null,'Reported as "Lock Consistency Violation" by ',Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/next/checker-racerd"}),"racerd"),"."),Object(r.b)("p",null,"This is a C++ and Objective C error reported whenever:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"A class contains a member ",Object(r.b)("inlineCode",{parentName:"li"},"lock")," used for synchronization (most often a\n",Object(r.b)("inlineCode",{parentName:"li"},"std::mutex"),")."),Object(r.b)("li",{parentName:"ul"},"It has a public method which writes to some member ",Object(r.b)("inlineCode",{parentName:"li"},"x")," while holding ",Object(r.b)("inlineCode",{parentName:"li"},"lock"),"."),Object(r.b)("li",{parentName:"ul"},"It has a public method which reads ",Object(r.b)("inlineCode",{parentName:"li"},"x")," without holding ",Object(r.b)("inlineCode",{parentName:"li"},"lock"),".")),Object(r.b)("p",null,"The above may happen through a chain of calls. Above, ",Object(r.b)("inlineCode",{parentName:"p"},"x")," may also be a\ncontainer (an array, a vector, etc)."),Object(r.b)("h3",{id:"fixing-lock-consistency-violation-reports"},"Fixing Lock Consistency Violation reports"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Avoid the offending access (most often the read). Of course, this may not be\npossible."),Object(r.b)("li",{parentName:"ul"},"Use synchronization to protect the read, by using the same lock protecting the\ncorresponding write."),Object(r.b)("li",{parentName:"ul"},"Make the method doing the read access private. This should silence the\nwarning, since Infer looks for a pair of non-private methods. Objective-C:\nInfer considers a method as private if it's not exported in the header-file\ninterface.")),Object(r.b)("h2",{id:"memory_leak"},"MEMORY_LEAK"),Object(r.b)("p",null,'Reported as "Memory Leak" by ',Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/next/checker-biabduction"}),"biabduction"),"."),Object(r.b)("h3",{id:"memory-leak-in-c"},"Memory leak in C"),Object(r.b)("p",null,"This error type is only reported in C and Objective-C code. In Java we do not\nreport memory leaks because it is a garbage collected language."),Object(r.b)("p",null,"In C, Infer reports memory leaks when objects are created with ",Object(r.b)("inlineCode",{parentName:"p"},"malloc")," and not\nfreed. For example:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-c"}),"-(void) memory_leak_bug {\n    struct Person *p = malloc(sizeof(struct Person));\n}\n")),Object(r.b)("h3",{id:"memory-leak-in-objective-c"},"Memory leak in Objective-C"),Object(r.b)("p",null,"Additionally, in Objective-C, Infer reports memory leaks that happen when\nobjects from Core Foundation or Core Graphics don't get released."),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-objectivec"}),"-(void) memory_leak_bug_cf {\n    CGPathRef shadowPath = CGPathCreateWithRect(self.inputView.bounds, NULL); //object created and not released.\n}\n")),Object(r.b)("h2",{id:"mixed_self_weakself"},"MIXED_SELF_WEAKSELF"),Object(r.b)("p",null,'Reported as "Mixed Self WeakSelf" by ',Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/next/checker-self-in-block"}),"self-in-block"),"."),Object(r.b)("p",null,"This happens when an Objective-C block captures both ",Object(r.b)("inlineCode",{parentName:"p"},"self")," and ",Object(r.b)("inlineCode",{parentName:"p"},"weakSelf"),", a\nweak pointer to ",Object(r.b)("inlineCode",{parentName:"p"},"self"),". Possibly the developer meant to capture only ",Object(r.b)("inlineCode",{parentName:"p"},"weakSelf"),"\nto avoid a retain cycle, but made a typo and used ",Object(r.b)("inlineCode",{parentName:"p"},"self")," as well in the block,\ninstead of ",Object(r.b)("inlineCode",{parentName:"p"},"strongSelf"),". In this case, this could cause a retain cycle."),Object(r.b)("h2",{id:"multiple_weakself"},"MULTIPLE_WEAKSELF"),Object(r.b)("p",null,'Reported as "Multiple WeakSelf Use" by ',Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/next/checker-self-in-block"}),"self-in-block"),"."),Object(r.b)("p",null,"An Objective-C block uses ",Object(r.b)("inlineCode",{parentName:"p"},"weakSelf")," more than once. This could lead to\nunexpected behaviour. Even if ",Object(r.b)("inlineCode",{parentName:"p"},"weakSelf")," is not nil in the first use, it could\nbe nil in the following uses since the object that ",Object(r.b)("inlineCode",{parentName:"p"},"weakSelf")," points to could be\nfreed anytime. One should assign it to a strong pointer first, and then use it\nin the block."),Object(r.b)("h2",{id:"mutable_local_variable_in_component_file"},"MUTABLE_LOCAL_VARIABLE_IN_COMPONENT_FILE"),Object(r.b)("p",null,'Reported as "Mutable Local Variable In Component File" by ',Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/next/checker-linters"}),"linters"),"."),Object(r.b)("p",null,Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"http://componentkit.org/docs/avoid-local-variables"}),"Doc in ComponentKit page")),Object(r.b)("h2",{id:"null_dereference"},"NULL_DEREFERENCE"),Object(r.b)("p",null,'Reported as "Null Dereference" by ',Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/next/checker-biabduction"}),"biabduction"),"."),Object(r.b)("p",null,"Infer reports null dereference bugs in C, Objective-C and Java. The issue is\nabout a pointer that can be ",Object(r.b)("inlineCode",{parentName:"p"},"null")," and it is dereferenced. This leads to a crash\nin all the above languages."),Object(r.b)("h3",{id:"null-dereference-in-c"},"Null dereference in C"),Object(r.b)("p",null,"Here is an example of an inter-procedural null dereference bug in C:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-c"}),"struct Person {\n  int age;\n  int height;\n  int weight;\n};\nint get_age(struct Person *who) {\n  return who->age;\n}\nint null_pointer_interproc() {\n  struct Person *joe = 0;\n  return get_age(joe);\n}\n")),Object(r.b)("h3",{id:"null-dereference-in-objective-c"},"Null dereference in Objective-C"),Object(r.b)("p",null,"In Objective-C, null dereferences are less common than in Java, but they still\nhappen and their cause can be hidden. In general, passing a message to nil does\nnot cause a crash and returns ",Object(r.b)("inlineCode",{parentName:"p"},"nil"),", but dereferencing a pointer directly does\ncause a crash as well as calling a ",Object(r.b)("inlineCode",{parentName:"p"},"nil")," block.C"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-objectivec"}),"-(void) foo:(void (^)())callback {\n    callback();\n}\n\n-(void) bar {\n    [self foo:nil]; //crash\n}\n")),Object(r.b)("p",null,"Moreover, there are functions from the libraries that do not allow ",Object(r.b)("inlineCode",{parentName:"p"},"nil")," to be\npassed as argument. Here are some examples:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-objectivec"}),'-(void) foo {\n    NSString *str = nil;\n    NSArray *animals = @[@"horse", str, @"dolphin"]; //crash\n}\n\n-(void) bar {\n  CGColorSpaceRef colorSpace = CGColorSpaceCreateDeviceRGB(); //can return NULL\n  ...\n  CFRelease(colorSpace); //crashes if called with NULL\n}\n')),Object(r.b)("h3",{id:"null-dereference-in-java"},"Null dereference in Java"),Object(r.b)("p",null,"Many of Infer's reports of potential NPE's come from code of the form"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),"  p = foo(); // foo() might return null\n  stuff();\n  p.goo();   // dereferencing p, potential NPE\n")),Object(r.b)("p",null,"If you see code of this form, then you have several options."),Object(r.b)("b",null," If you are unsure whether or not foo() will return null "),", you should ideally i. Change the code to ensure that foo() can not return null ii. Add a check for whether p is null, and do something other than dereferencing p when it is null.",Object(r.b)("p",null,"Sometimes, in case ii it is not obvious what you should do when p is null. One\npossibility (a last option) is to throw an exception, failing early. This can be\ndone using checkNotNull as in the following code:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),"  // code idiom for failing early\n\n  import static com.google.common.base.Preconditions.checkNotNull;\n\n  //... intervening code\n\n  p = checkNotNull(foo()); // foo() might return null\n  stuff();\n  p.goo();   // dereferencing p, potential NPE\n")),Object(r.b)("p",null,"The call checkNotNull(foo()) will never return null; in case foo() returns null\nit fails early by throwing an NPE."),Object(r.b)("b",null," If you are absolutely sure that foo() will not be null "),", then if you land your diff this case will no longer be reported after your diff makes it to master. In the future we might include analysis directives (hey, analyzer, p is not null!) like in Hack that tell the analyzer the information that you know, but that is for later.",Object(r.b)("h2",{id:"parameter_not_null_checked"},"PARAMETER_NOT_NULL_CHECKED"),Object(r.b)("p",null,'Reported as "Parameter Not Null Checked" by ',Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/next/checker-biabduction"}),"biabduction"),"."),Object(r.b)("p",null,"This error type is reported only in Objective-C. It is similar to Null\ndereference, but Infer hasn't found a whole trace where the error can happen,\nbut only found that a null dereference can happen if you call a method with nil\nas an argument. Therefore it is only a warning. For example:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-objectivec"}),"  -(int) foo:(A* a) {\n      B b* = [a foo]; // sending a message with receiver nil returns nil\n      return b->x; // dereferencing b, potential NPE if you pass nil as the argument a.\n  }\n")),Object(r.b)("p",null,"or when the parameter is a block:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-objectivec"}),"   -(void) foo:(void (^)(BOOL))block {\n      block(YES); // calling a nil block will cause a crash.\n   }\n")),Object(r.b)("p",null,"Possible solutions are adding a check for ",Object(r.b)("inlineCode",{parentName:"p"},"nil"),", or making sure that the method\nis not called with ",Object(r.b)("inlineCode",{parentName:"p"},"nil"),". When an argument will never be ",Object(r.b)("inlineCode",{parentName:"p"},"nil"),", you can add the\nannotation ",Object(r.b)("inlineCode",{parentName:"p"},"nonnull")," to the argument's type, to tell Infer (and the type\nsystem), that the argument won't be ",Object(r.b)("inlineCode",{parentName:"p"},"nil"),". This will silence the warning."),Object(r.b)("h2",{id:"pointer_to_const_objc_class"},"POINTER_TO_CONST_OBJC_CLASS"),Object(r.b)("p",null,'Reported as "Pointer To Const Objc Class" by ',Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/next/checker-linters"}),"linters"),"."),Object(r.b)("p",null,"In Objective-C, ",Object(r.b)("inlineCode",{parentName:"p"},"const Class *")," represents a mutable pointer pointing to an\nObjective-C class where the ivars cannot be changed. More useful is\n",Object(r.b)("inlineCode",{parentName:"p"},"Class *const")," instead, meaning the destination of the pointer cannot be\nchanged."),Object(r.b)("h2",{id:"premature_nil_termination_argument"},"PREMATURE_NIL_TERMINATION_ARGUMENT"),Object(r.b)("p",null,'Reported as "Premature Nil Termination Argument" by ',Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/next/checker-biabduction"}),"biabduction"),"."),Object(r.b)("p",null,"This error type is reported in C and Objective-C. In many variadic methods,\n",Object(r.b)("inlineCode",{parentName:"p"},"nil")," is used to signify the end of the list of input objects. This is similar\nto nil-termination of C strings. If one of the arguments that is not the last\nargument to the method is ",Object(r.b)("inlineCode",{parentName:"p"},"nil")," as well, Infer reports an error because that may\nlead to unexpected behavior."),Object(r.b)("p",null,"An example of such variadic methods is\n",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://developer.apple.com/library/prerelease/ios/documentation/Cocoa/Reference/Foundation/Classes/NSArray_Class/index.html#//apple_ref/occ/clm/NSArray/arrayWithObjects"}),"arrayWithObjects")),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-objectivec"}),'  NSArray *foo = [NSArray arrayWithObjects: @"aaa", str, @"bbb", nil];\n')),Object(r.b)("p",null,"In this example, if ",Object(r.b)("inlineCode",{parentName:"p"},"str")," is ",Object(r.b)("inlineCode",{parentName:"p"},"nil")," then an array ",Object(r.b)("inlineCode",{parentName:"p"},'@[@"aaa"]')," of size 1 will be\ncreated, and not an array ",Object(r.b)("inlineCode",{parentName:"p"},'@[@"aaa", str, @"bbb"]')," of size 3 as expected."),Object(r.b)("h2",{id:"registered_observer_being_deallocated"},"REGISTERED_OBSERVER_BEING_DEALLOCATED"),Object(r.b)("p",null,'Reported as "Registered Observer Being Deallocated" by ',Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/next/checker-linters"}),"linters"),"."),Object(r.b)("p",null,"Objects register with a notification center to receive notifications. This check\nwarns you when an object is registered as observer of a NSNotificationCenter but\nit is never unregistered. This is problematic as if the object is not\nunregistered the notification center can still send notification even after the\nobject has been deallocated. In that case we would get a crash."),Object(r.b)("h2",{id:"resource_leak"},"RESOURCE_LEAK"),Object(r.b)("p",null,'Reported as "Resource Leak" by ',Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/next/checker-biabduction"}),"biabduction"),"."),Object(r.b)("p",null,"Infer reports resource leaks in C, Objective-C and Java. In general, resources\nare entities such as files, sockets, connections, etc, that need to be closed\nafter being used."),Object(r.b)("h3",{id:"resource-leak-in-c"},"Resource leak in C"),Object(r.b)("p",null,"This is an example of a resource leak in C code:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-c"}),'-(void) resource_leak_bug {\n    FILE *fp;\n    fp=fopen("c:\\\\test.txt", "r"); // file opened and not closed.\n}\n')),Object(r.b)("h3",{id:"resource-leak-in-java"},"Resource leak in Java"),Object(r.b)("p",null,"For the remaining of this section, we will consider examples of resource leaks\nin Java code."),Object(r.b)("p",null,"TIP: A common source of bugs is ",Object(r.b)("b",null,"exceptions skipping past close()\nstatements"),". That is the first thing to look for if INFER reports a potential\nresource leak."),Object(r.b)("h3",{id:"basics-and-standard-idiom"},"Basics and Standard Idiom"),Object(r.b)("p",null,"Some objects in Java, the ",Object(r.b)("i",null,"resources"),", are supposed to be closed when you\nstop using them, and failure to close is a ",Object(r.b)("i",null,"resource leak"),". Resources\ninclude input streams, output streams, readers, writers, sockets, http\nconnections, cursors, and json parsers."),Object(r.b)("p",null,"The standard idiom is"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),"  // Standard idiom\n  Allocate resource\n  try {\n    do some stuff\n  } finally {\n    close resource\n  }\n")),Object(r.b)("p",null,"or more for example,"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),'  //  Standard Idiom\n  public static void foo () throws IOException{\n    FileOutputStream fos = new FileOutputStream(new File("whatever.txt"));\n    try {\n      fos.write(7);\n    } finally {\n      fos.close();\n    }\n  }\n')),Object(r.b)("p",null,"and you should use the standard idiom for the most part, when you don't want to\nreturn the resource to the surrounding context."),Object(r.b)("p",null,"Sometimes people just leave out close(), and that is a bug, but more typically\nexceptional paths are the root of the problem, as in"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),'  // leak because of exception\n  public static void foo () throws IOException {\n    FileOutputStream fos = new FileOutputStream(new File("whatever.txt"));\n    fos.write(7);   //DOH! What if exception?\n    fos.close();\n  }\n')),Object(r.b)("p",null,"where an exception in fos.write will cause execution to skip past the close()\nstatement."),Object(r.b)("h4",{id:"multiple-resources-bugs"},"Multiple Resources Bugs"),Object(r.b)("p",null,"We can deal with multiple resources correctly and simply just by nesting the\nstandard idiom."),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),'  // Two Resources nested\n  public static void foo() throws IOException {\n    FileInputStream fis = new FileInputStream(new File("whatever.txt"));\n    try {\n      FileOutputStream fos = new FileOutputStream(new File("everwhat.txt"));\n      try {\n        fos.write(fis.read());\n      } finally {\n        fos.close();\n      }\n    } finally {\n      fis.close();\n    }\n  }\n')),Object(r.b)("p",null,"Bugs often occur when using multiple resources in other ways because of\nexceptions in close() methods. For example,"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),'  // Classic Two Resources Bug\n  public static void foo() throws IOException {\n    FileInputStream fis = null;\n    FileOutputStream fos = null;\n    try {\n      fis = new FileInputStream(new File("whatever.txt"));\n      fos = new FileOutputStream(new File("everwhat.txt"));\n      fos.write(fis.read());\n    } finally {\n      if (fis!=null)  fis.close();\n      if (fos!=null) fos.close();\n    }\n  }\n')),Object(r.b)("p",null,"Here, if there is an exception in the call to fis.close() execution will skip\npast fos.close(); a leak."),Object(r.b)("p",null,"Another way, besides the standard idiom, to deal with this problem is to swallow\nexceptions."),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),'  // Two Resources Fix 1\n  public static void foo() throws IOException {\n    FileInputStream fis = null;\n    FileOutputStream fos = null;\n    try {\n      fis = new FileInputStream(new File("whatever.txt"));\n      fos = new FileOutputStream(new File("everwhat.txt"));\n      fos.write(fis.read());\n    } finally {\n      try {\n        if (fis!=null) fis.close();\n      } catch (Exception e) {};  // Exception swallowing\n      if (fos!=null) fos.close();\n    }\n  }\n')),Object(r.b)("p",null,"You can also swallow the exception on the output stream. Some people prefer not\nto swallow output stream exceptions, and also flush before closing.\n",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"http://code.google.com/p/guava-libraries/issues/detail?id=1118"}),"http://code.google.com/p/guava-libraries/issues/detail?id=1118")),Object(r.b)("p",null,"Notice that the nested standard idiom does not need the checks for null, which\nare in there in this case to protect against the case when one of the\nallocations throws an exception, in which case one would get a\nNullPointerException."),Object(r.b)("h3",{id:"nested_allocations"},"Nested_Allocations"),Object(r.b)("p",null,"When a resource allocation is included as an argument to a constructor, if the\nconstructor fails it can leave an an unreachable resource that no one can close."),Object(r.b)("p",null,"For example gzipOutputStream = new GZIPOutputStream(new FileOutputStream(out));\nis bad in case the outer constructor, GZIPOutputStream, throws an exception. In\nthat case, no one will have a hold of the FileOutputStream and so no one will be\nable to close it."),Object(r.b)("p",null,"In such a case you need to move the allocation the FileOutputStream out of the\nnested position and name it, so you are able to close if anything goes wrong\nduring execution of the GZIPOutputStream constructor."),Object(r.b)("p",null,"Here are resources that can throw exceptions i their constructor(s)."),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"ObjectInputStream , ObjectOutputStream, PipedInputStream, PipedOutputStream,\nPipedReader, PipedWriter, JarInputStream, JarOutputStream, GZIPInputStream,\nGZIPOutputStream , ZipFile all throw IOException"),Object(r.b)("li",{parentName:"ul"},"PrintStream throws UnsupportedEncodingException")),Object(r.b)("p",null,"The constructors for FileInputStream, FileOutputStream and RandomAccessFile\nthrow FileNotFoundException, but these cases are not problematic in the sense\nthat their arguments are not resources and so they do not cause the nested\nresource leak."),Object(r.b)("h3",{id:"allocation-of-jsonparser-and-cursor-resources"},"Allocation of JSonParser and Cursor resources"),Object(r.b)("p",null,'Some resources are created inside libraries instead of by "new".'),Object(r.b)("p",null,"Cursor is an interface, the actual resources are something like SQLiteCursor.\nSo, every time you call a function that returns a Cursor object, there is an\nallocation."),Object(r.b)("p",null,"For instance, in the functions from SQLiteDatabase query(\u2026) and rawQuery(\u2026)\nallocate a cursor resource. For SQLiteQueryBuilder, ContentProviderClient,\nContentResolver. MediaStore and DownloadManager it is only query(\u2026) Cursor\nobjects cursor created by these functions need to be closed (i.e.,\ncursor.close())."),Object(r.b)("p",null,"Similarly, JsonParser is an abstract class, and create a resource in functions\nfrom the class JsonFactory createParser(byte[] data) createParser(byte[] data,\nint offset, int len) createParser(String content) createParser(URL url)\ncreateParser(File f) JsonParser objects js created by these functions need to be\nclosed (jp.close()). On the other hand . JasonParsers gotten from\ncreateParser(InputStream in) and createParser(Reader r) give you JsonParsers\nthat don\u2019t need to be closed. This is because they receive the resource from\nsomewhere that will maintain the responsibility to close it."),Object(r.b)("h3",{id:"escaping-resources-and-exceptions"},"Escaping resources and exceptions"),Object(r.b)("p",null,"Sometimes you want to return a resource to the outside, in which case you should\nnot close it, but you still need to be careful of exceptions in case control\nskips past the return leaving no one to close. Here is a simple example of a\npositive use of escaping resources."),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),"  // An escaping resource, shouldn't close\n  public BugReportAttachment createAttachment(File reportDirectory, String fileName)\n      throws FileNotFoundException {\n    File file = new File(reportDirectory, fileName);\n    OutputStream stream = new FileOutputStream(file);\n    return new BugReportAttachment(Uri.fromFile(file), stream);\n  }\n")),Object(r.b)("p",null,"In this case it is intended that an object that wraps ",Object(r.b)("inlineCode",{parentName:"p"},"stream")," is passed to the\ncaller of ",Object(r.b)("inlineCode",{parentName:"p"},"createAttachment"),". You should certainly not close stream here,\nbecause it is being passed to the outside."),Object(r.b)("p",null,"But for escaping resources like this you still need to be careful of exceptions.\nFor example, in"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),"  // An escaping resource, and a leak\n  public BugReportAttachment createAttachment(File reportDirectory, String fileName)\n      throws FileNotFoundException {\n    File file = new File(reportDirectory, fileName);\n    OutputStream stream = new FileOutputStream(file);\n    stream.write(7);\n    return new BugReportAttachment(Uri.fromFile(file), stream);\n  }\n")),Object(r.b)("p",null,"if stream.write(7) throws an exception, then no one will have a hold of stream,\nand no one will be able to close it; a leak."),Object(r.b)("h3",{id:"java-7s-try-with-resources"},"Java 7's try-with-resources"),Object(r.b)("p",null,Object(r.b)("strong",{parentName:"p"},"(For use with Java 7 only)")),Object(r.b)("p",null,"Clearly, accounting for the ramifications of all the exceptional cases is\ncomplicated, and there is a better way in Java 7."),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),'  // Two Resources Fix 2; via try-with-resources\n  public static void foo() throws IOException {\n    try (\n      FileInputStream fis = new FileInputStream(new File("whatever.txt"));\n      FileOutputStream fos = new FileOutputStream(new File("everwhat.txt"))\n    ) {\n      fos.write(fis.read());\n    }\n  }\n')),Object(r.b)("p",null,"All the complicated exceptional cases above are (apparently) covered by this\nconstruct, and the result is much simpler."),Object(r.b)("p",null,"So, if you are trying to fix a potential leak in code with multiples resources\nyou can go ahead and try to understand whether the potential leak is real. Or,\nif the code is complex and it is hard to figure out, it would be perfectly\nlegitimate to simply convert the code over to try-with-resources if you have\naccess to Java 7, so as to save yourself some brain-cycles. You will also end up\nwith cleaner code."),Object(r.b)("p",null,"If try-with-resources is so great you should ",Object(r.b)("i",null,"always"),' use it. But you\nshouldn\'t\u2026 Try-with-resources gives resources static scoping, and works via a\nstack discipline. Sometimes, you want a resource to persist beyond scope, as in\nthe escaping example above. In an escaping example maybe you could refactor lots\nof code so that try-with-resources applies, and maybe you cannot in a sensible\nway. This just illustrates that, though you might hear people say that\ntry-with-resources "solves" the resource problem, it does not. It is very\nuseful, but you cannot use it blindly when you see a resource-allocation site.'),Object(r.b)("h2",{id:"retain_cycle"},"RETAIN_CYCLE"),Object(r.b)("p",null,'Reported as "Retain Cycle" by ',Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/next/checker-biabduction"}),"biabduction"),"."),Object(r.b)("p",null,"A retain cycle is a situation when object A retains object B, and object B\nretains object A at the same time. Here is an example:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-objectivec"}),"@class Child;\n@interface Parent : NSObject {\n    Child *child; // Instance variables are implicitly __strong\n}\n@end\n@interface Child : NSObject {\n    Parent *parent;\n}\n@end\n")),Object(r.b)("p",null,"You can fix a retain cycle in ARC by using ","_","_",'weak variables or weak properties\nfor your "back links", i.e. links to direct or indirect parents in an object\nhierarchy:'),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-objectivec"}),"@class Child;\n@interface Parent : NSObject {\n    Child *child;\n}\n@end\n@interface Child : NSObject {\n    __weak Parent *parent;\n}\n@end\n")),Object(r.b)("h2",{id:"starvation"},"STARVATION"),Object(r.b)("p",null,'Reported as "UI Thread Starvation" by ',Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/next/checker-starvation"}),"starvation"),"."),Object(r.b)("p",null,"This error is reported in Java, and specifically on Android. These reports are\ntriggered when a method that runs on the UI thread may block, thus potentially\nleading to an Application Not Responding error."),Object(r.b)("p",null,"Infer considers a method as running on the UI thread whenever:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"The method, one of its overrides, its class, or an ancestral class, is\nannotated with ",Object(r.b)("inlineCode",{parentName:"li"},"@UiThread"),"."),Object(r.b)("li",{parentName:"ul"},"The method, or one of its overrides is annotated with ",Object(r.b)("inlineCode",{parentName:"li"},"@OnEvent"),", ",Object(r.b)("inlineCode",{parentName:"li"},"@OnClick"),",\netc."),Object(r.b)("li",{parentName:"ul"},"The method or its callees call a ",Object(r.b)("inlineCode",{parentName:"li"},"Litho.ThreadUtils")," method such as\n",Object(r.b)("inlineCode",{parentName:"li"},"assertMainThread"),".")),Object(r.b)("p",null,"The issue is reported when a method deemed to run on the UI thread"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Makes a method call which may block."),Object(r.b)("li",{parentName:"ul"},"Takes a lock, and another thread takes the same lock, and before releasing it,\nmakes a call that may block.")),Object(r.b)("p",null,"Calls that may block are considered:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Certain I/O calls."),Object(r.b)("li",{parentName:"ul"},"Two way ",Object(r.b)("inlineCode",{parentName:"li"},"Binder.transact")," calls."),Object(r.b)("li",{parentName:"ul"},"Certain OS calls."),Object(r.b)("li",{parentName:"ul"},Object(r.b)("inlineCode",{parentName:"li"},"Future")," or ",Object(r.b)("inlineCode",{parentName:"li"},"AsyncTask")," calls to ",Object(r.b)("inlineCode",{parentName:"li"},"get")," without timeouts, or with too large\ntimeouts.")),Object(r.b)("p",null,"To suppress starvation reports in a method ",Object(r.b)("inlineCode",{parentName:"p"},"m()")," use the\n",Object(r.b)("inlineCode",{parentName:"p"},'@SuppressLint("STARVATION")')," annotation, as follows:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),'  import android.annotation.SuppressLint;\n\n  @SuppressLint("STARVATION")\n  public void m() {\n  ...\n  }\n')),Object(r.b)("p",null,"To signal to Infer that a method does not perform any blocking calls, despite\nappearences, you can use the ",Object(r.b)("inlineCode",{parentName:"p"},"@NonBlocking")," annotation:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-java"}),"  import com.facebook.infer.annotation.NonBlocking;\n\n  @NonBlocking\n  public void m() {\n  ...\n  }\n")),Object(r.b)("p",null,"This instructs Infer to filter out any potentially blocking calls in ",Object(r.b)("inlineCode",{parentName:"p"},"m()"),"\n(also, transitively), and thus any other method can expect no starvation reports\ndue to a call to ",Object(r.b)("inlineCode",{parentName:"p"},"m()"),". You will need to set up your class path appropriately to\ninclude the JAR files in ",Object(r.b)("inlineCode",{parentName:"p"},"infer/annotations")," for this annotation to work."),Object(r.b)("h2",{id:"static_initialization_order_fiasco"},"STATIC_INITIALIZATION_ORDER_FIASCO"),Object(r.b)("p",null,'Reported as "Static Initialization Order Fiasco" by ',Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/next/checker-siof"}),"siof"),"."),Object(r.b)("p",null,"This error is reported in C++. It fires when the initialization of a static\nvariable ",Object(r.b)("inlineCode",{parentName:"p"},"A"),", accesses a static variable ",Object(r.b)("inlineCode",{parentName:"p"},"B")," from another translation unit\n(usually another ",Object(r.b)("inlineCode",{parentName:"p"},".cpp")," file). There are no guarantees whether ",Object(r.b)("inlineCode",{parentName:"p"},"B")," has been\nalready initialized or not at that point."),Object(r.b)("p",null,"For more technical definition and techniques to avoid/remediate, see the\n",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://isocpp.org/wiki/faq/ctors#static-init-order"}),"FAQ"),"."),Object(r.b)("h2",{id:"strict_mode_violation"},"STRICT_MODE_VIOLATION"),Object(r.b)("p",null,'Reported as "Strict Mode Violation" by ',Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/next/checker-starvation"}),"starvation"),"."),Object(r.b)("p",null,"Android has a feature called\n",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"https://developer.android.com/reference/android/os/StrictMode"}),"strict mode"),",\nwhich if enabled, will flag the occasions where the main thread makes a call\nthat results in disk I/O, waiting on a network socket, etc. The analysis\ncatching starvation errors and deadlocks (the ",Object(r.b)("inlineCode",{parentName:"p"},"--starvation")," analysis) has the\nability to statically detect such violations."),Object(r.b)("p",null,"To suppress this warning, it's enough to annotate the offending method with\n",Object(r.b)("inlineCode",{parentName:"p"},'@SuppressLint("STRICT_MODE_VIOLATION")'),"."),Object(r.b)("h2",{id:"strong_delegate_warning"},"STRONG_DELEGATE_WARNING"),Object(r.b)("p",null,'Reported as "Strong Delegate Warning" by ',Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/next/checker-linters"}),"linters"),"."),Object(r.b)("p",null,"This check warns you when you have a property called delegate or variations\nthereof which is declared strong. The idea is that delegates should generally be\nweak, otherwise this may cause retain cycles."),Object(r.b)("h2",{id:"strong_self_not_checked"},"STRONG_SELF_NOT_CHECKED"),Object(r.b)("p",null,'Reported as "StrongSelf Not Checked" by ',Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/next/checker-self-in-block"}),"self-in-block"),"."),Object(r.b)("p",null,"When a block captures ",Object(r.b)("inlineCode",{parentName:"p"},"weakSelf")," in the following pattern:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{}),"__weak __typeof(self) weakSelf = self;\n  int (^my_block)() = ^() {\n    __strong __typeof(weakSelf) strongSelf = weakSelf;\n    int y = strongSelf->x;\n")),Object(r.b)("p",null,"the variable ",Object(r.b)("inlineCode",{parentName:"p"},"strongSelf")," should be checked for ",Object(r.b)("inlineCode",{parentName:"p"},"null")," before being used,\notherwise this could cause a crash because the weak pointer ",Object(r.b)("inlineCode",{parentName:"p"},"weakSelf")," could be\n",Object(r.b)("inlineCode",{parentName:"p"},"null"),"."),Object(r.b)("h2",{id:"thread_safety_violation"},"THREAD_SAFETY_VIOLATION"),Object(r.b)("p",null,'Reported as "Thread Safety Violation" by ',Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/next/checker-racerd"}),"racerd"),"."),Object(r.b)("p",null,"This warning indicates a potential data race in Java. The analyser is called\nRacerD and this section gives brief but a mostly complete description of its\nfeatures. See the ",Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/racerd"}),"RacerD page")," for more in-depth information and\nexamples."),Object(r.b)("p",null,"NB this warning ",Object(r.b)("strong",{parentName:"p"},"is not related to @GuardedBy")," and not issued by the same\nanalysis."),Object(r.b)("h3",{id:"thread-safety-what-is-a-data-race"},"Thread-safety: What is a data race"),Object(r.b)("p",null,"Here a data race is a pair of accesses to the same member field such that:"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"at least one is a write, and,"),Object(r.b)("li",{parentName:"ul"},"at least one occurs without any lock synchronization, and,"),Object(r.b)("li",{parentName:"ul"},"the two accesses occur on threads (if known) which can run in parallel.")),Object(r.b)("h3",{id:"thread-safety-potential-fixes"},"Thread-safety: Potential fixes"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"Synchronizing the accesses (using the ",Object(r.b)("inlineCode",{parentName:"li"},"synchronized")," keyword, thread-exclusion\nsuch as atomic objects, ",Object(r.b)("inlineCode",{parentName:"li"},"volatile")," etc)."),Object(r.b)("li",{parentName:"ul"},"Making an offending method private -- this will exclude it from being checked\nat the top level, though it will be checked if called by a public method which\nmay itself, e.g., hold a lock when calling it."),Object(r.b)("li",{parentName:"ul"},"Putting the two accesses on the same thread, e.g., by using ",Object(r.b)("inlineCode",{parentName:"li"},"@MainThread")," or\n",Object(r.b)("inlineCode",{parentName:"li"},"@ThreadConfined"),".")),Object(r.b)("h3",{id:"thread-safety-conditions-checked-before-reporting"},"Thread-safety: Conditions checked before reporting"),Object(r.b)("p",null,"The class and method are not marked ",Object(r.b)("inlineCode",{parentName:"p"},"@ThreadSafe(enableChecks = false)"),", and,"),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},"The method is declared ",Object(r.b)("inlineCode",{parentName:"li"},"synchronized"),", or employs (non-transitively) locking,\nor,"),Object(r.b)("li",{parentName:"ul"},"The class is not marked ",Object(r.b)("inlineCode",{parentName:"li"},"@NotThreadSafe"),", and,",Object(r.b)("ul",{parentName:"li"},Object(r.b)("li",{parentName:"ul"},"The class/method is marked ",Object(r.b)("inlineCode",{parentName:"li"},"@ThreadSafe,")," or one of the configured synonyms\nin ",Object(r.b)("inlineCode",{parentName:"li"},".inferconfig"),", or,"),Object(r.b)("li",{parentName:"ul"},"A parent class, or an override method are marked with the above annotations.")))),Object(r.b)("p",null,"NB currently RacerD ",Object(r.b)("strong",{parentName:"p"},"does not take into account ",Object(r.b)("inlineCode",{parentName:"strong"},"@GuardedBy")),"."),Object(r.b)("h3",{id:"thread-safety-thread-annotations-recognized-by-racerd"},"Thread-safety: Thread annotations recognized by RacerD"),Object(r.b)("p",null,"These class and method annotations imply the method is on the main thread:\n",Object(r.b)("inlineCode",{parentName:"p"},"@MainThread"),", ",Object(r.b)("inlineCode",{parentName:"p"},"@UiThread")),Object(r.b)("p",null,"These method annotations imply the method is on the main thread: ",Object(r.b)("inlineCode",{parentName:"p"},"@OnBind"),",\n",Object(r.b)("inlineCode",{parentName:"p"},"@OnEvent"),", ",Object(r.b)("inlineCode",{parentName:"p"},"@OnMount"),", ",Object(r.b)("inlineCode",{parentName:"p"},"@OnUnbind"),", ",Object(r.b)("inlineCode",{parentName:"p"},"@OnUnmount")),Object(r.b)("p",null,"Both classes of annotations work through the inheritance tree (i.e. if a parent\nclass or method is marked with one of these annotations, so is the child class /\nmethod override)."),Object(r.b)("p",null,"In addition to these, RacerD recognizes many lifecycle methods as necessarily\nrunning on the main thread, eg ",Object(r.b)("inlineCode",{parentName:"p"},"Fragment.onCreate")," etc."),Object(r.b)("p",null,"Finally, the thread status of being on the main thread propagates backwards\nthrough the call graph (ie if ",Object(r.b)("inlineCode",{parentName:"p"},"foo")," calls ",Object(r.b)("inlineCode",{parentName:"p"},"bar")," and ",Object(r.b)("inlineCode",{parentName:"p"},"bar")," is marked ",Object(r.b)("inlineCode",{parentName:"p"},"@UiThtread"),"\nthen ",Object(r.b)("inlineCode",{parentName:"p"},"foo")," is automatically considered on the main thread too). Calling\n",Object(r.b)("inlineCode",{parentName:"p"},"assertMainThread"),", ",Object(r.b)("inlineCode",{parentName:"p"},"assertOnUiThread"),", ",Object(r.b)("inlineCode",{parentName:"p"},"checkOnMainThread")," has the same effect."),Object(r.b)("p",null,"NB RacerD currently ",Object(r.b)("strong",{parentName:"p"},"does not recognize ",Object(r.b)("inlineCode",{parentName:"strong"},"@WorkerThread"),", ",Object(r.b)("inlineCode",{parentName:"strong"},"@BinderThread")," or\n",Object(r.b)("inlineCode",{parentName:"strong"},"@AnyThread")),"."),Object(r.b)("h3",{id:"thread-safety-other-annotations-and-what-they-do"},"Thread-safety: Other annotations and what they do"),Object(r.b)("p",null,"These annotations can be found at ",Object(r.b)("inlineCode",{parentName:"p"},"com.facebook.infer.annotation.*"),"."),Object(r.b)("ul",null,Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},Object(r.b)("inlineCode",{parentName:"p"},"@Functional")," This is a method annotation indicating the method always returns\nthe same value. When a method ",Object(r.b)("inlineCode",{parentName:"p"},"foo")," is annotated ",Object(r.b)("inlineCode",{parentName:"p"},"@Functional"),", RacerD will\nignore any writes of the return value of ",Object(r.b)("inlineCode",{parentName:"p"},"foo"),". For example, in\n",Object(r.b)("inlineCode",{parentName:"p"},"this.x = foo()"),", the write to ",Object(r.b)("inlineCode",{parentName:"p"},"this.x")," is ignored. The reasoning is that if\nthe method returns the same value whenever it's called, any data race on\n",Object(r.b)("inlineCode",{parentName:"p"},"this.x")," is benign, if that is the only write.")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},Object(r.b)("inlineCode",{parentName:"p"},"@ThreadConfined")," This is a class/method/field annotation which takes a single\nparameter which can be ",Object(r.b)("inlineCode",{parentName:"p"},"UI"),", ",Object(r.b)("inlineCode",{parentName:"p"},"ANY")," or a user chosen string. It indicates to\nRacerD a thread identifier for the class/method/field. Thus,\n",Object(r.b)("inlineCode",{parentName:"p"},"@ThreadConfined(UI)")," is equivalent to ",Object(r.b)("inlineCode",{parentName:"p"},"@UiThread"),", and ",Object(r.b)("inlineCode",{parentName:"p"},"@ThreadConfined(ANY)"),"\nis equivalent to not having the annotation at all, for classes and methods.\nWhen this annotation is applied to a field it instructs Infer to assume\n(without checking) that all accesses to that field are made on the same thread\n(and can, therefore, not race by definition). The intention is that RacerD\nuses that to detect exclusion between accesses occurring on the same thread.\nHowever, only the UI thread is supported at this time, and any user provided\nvalue is considered equal to ",Object(r.b)("inlineCode",{parentName:"p"},"UI"),".")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},Object(r.b)("inlineCode",{parentName:"p"},"@VisibleForTesting")," A method annotation making Infer consider the method as\neffectively ",Object(r.b)("inlineCode",{parentName:"p"},"private"),". This means it will not be checked for races against\nother non-private methods of the class, but only if called by one.")),Object(r.b)("li",{parentName:"ul"},Object(r.b)("p",{parentName:"li"},Object(r.b)("inlineCode",{parentName:"p"},"@ReturnsOwnership")," A method annotation indicating that the method returns a\nfreshly owned object. Accesses to the returned value will not be considered\nfor data races, as the object is in-effect unique and not accessible yet from\nother threads. The main utility of this annotation is in interfaces, where\nInfer cannot look up the implementation and decide for itself."))),Object(r.b)("h2",{id:"unavailable_api_in_supported_ios_sdk"},"UNAVAILABLE_API_IN_SUPPORTED_IOS_SDK"),Object(r.b)("p",null,'Reported as "Unavailable Api In Supported Ios Sdk" by ',Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/next/checker-linters"}),"linters"),"."),Object(r.b)("p",null,"This checks warns you when you are using an API (constant, method call, etc.)\nthat is only defined in a version higher than the version that you support. To\nenable this check, pass to Infer the option\n",Object(r.b)("inlineCode",{parentName:"p"},"--iphoneos-target-sdk-version version"),". Calling an undefined API will lead to a\ncrash in the app. To fix this, you can choose a different API or use it inside\nan if, as in:"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-objectivec"}),"if ([UIFont respondsToSelector:@selector(systemFontOfSize:weight:)]) {\n  font = [UIFont systemFontOfSize:size weight:0];\n}\n")),Object(r.b)("p",null,"or"),Object(r.b)("pre",null,Object(r.b)("code",Object(a.a)({parentName:"pre"},{className:"language-objectivec"}),"if (kCFCoreFoundationVersionNumber >= kCFCoreFoundationVersionNumber_iOS_9_0) {\n  font = [UIFont systemFontOfSize:size weight:0];\n}\n")),Object(r.b)("h2",{id:"weak_self_in_no_escape_block"},"WEAK_SELF_IN_NO_ESCAPE_BLOCK"),Object(r.b)("p",null,'Reported as "Weak Self In No Escape Block" by ',Object(r.b)("a",Object(a.a)({parentName:"p"},{href:"/docs/next/checker-self-in-block"}),"self-in-block"),"."),Object(r.b)("p",null,"In many methods that take a block as an argument, the block position is\nannotated with NS_NOESCAPE to mark that the block passed to this method won't be\nleaving the current scope. In those cases, there is no need to use ",Object(r.b)("inlineCode",{parentName:"p"},"weakSelf")," to\navoid the block to capture ",Object(r.b)("inlineCode",{parentName:"p"},"self"),". This issue type flags this case."))}b.isMDXComponent=!0},232:function(e,t,n){"use strict";n.d(t,"a",(function(){return d})),n.d(t,"b",(function(){return h}));var a=n(0),i=n.n(a);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t){if(null==e)return{};var n,a,i=function(e,t){if(null==e)return{};var n,a,i={},r=Object.keys(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||(i[n]=e[n]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(a=0;a<r.length;a++)n=r[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(i[n]=e[n])}return i}var s=i.a.createContext({}),b=function(e){var t=i.a.useContext(s),n=t;return e&&(n="function"==typeof e?e(t):l({},t,{},e)),n},d=function(e){var t=b(e.components);return i.a.createElement(s.Provider,{value:t},e.children)},p={inlineCode:"code",wrapper:function(e){var t=e.children;return i.a.createElement(i.a.Fragment,{},t)}},u=Object(a.forwardRef)((function(e,t){var n=e.components,a=e.mdxType,r=e.originalType,o=e.parentName,s=c(e,["components","mdxType","originalType","parentName"]),d=b(n),u=a,h=d["".concat(o,".").concat(u)]||d[u]||p[u]||r;return n?i.a.createElement(h,l({ref:t},s,{components:n})):i.a.createElement(h,l({ref:t},s))}));function h(e,t){var n=arguments,a=t&&t.mdxType;if("string"==typeof e||a){var r=n.length,o=new Array(r);o[0]=u;var l={};for(var c in t)hasOwnProperty.call(t,c)&&(l[c]=t[c]);l.originalType=e,l.mdxType="string"==typeof e?e:a,o[1]=l;for(var s=2;s<r;s++)o[s]=n[s];return i.a.createElement.apply(null,o)}return i.a.createElement.apply(null,n)}u.displayName="MDXCreateElement"}}]);